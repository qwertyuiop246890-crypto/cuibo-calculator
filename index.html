<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>跨境電商精算專家 V3.3 - 內部版</title>
    <!-- 使用 CDN 載入 React 與 Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body { font-family: 'Inter', 'Microsoft JhengHei', sans-serif; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            const [jpyPrice, setJpyPrice] = useState(0);
            const [weight, setWeight] = useState(0);
            const [bankRate, setBankRate] = useState(0.215);
            const [resultA, setResultA] = useState(null);
            const [resultB, setResultB] = useState(null);

            const calculatePricing = (isSchemeB = false) => {
                const finalRate = parseFloat(bankRate) + 0.02;
                const creditCardFee = 1.015;
                
                const sourcingFeeRate = isSchemeB ? 0 : 0.1;
                const shippingRate = isSchemeB ? 0 : 0.252;
                const domesticJpy = isSchemeB ? 0 : 150;
                
                const baseCost = (jpyPrice * finalRate * creditCardFee) + (weight * shippingRate);
                const sourcingFee = jpyPrice * finalRate * sourcingFeeRate;
                const domesticTwd = domesticJpy * finalRate;
                const totalCost = baseCost + sourcingFee + domesticTwd;

                let profit = 0;
                if (totalCost < 100) profit = 40;
                else if (totalCost < 200) profit = 60;
                else if (totalCost < 300) profit = 80;
                else profit = Math.max(totalCost * 0.2, 100);

                let divisor = 0.89;
                let tempPrice = (totalCost + profit) / divisor;
                if (tempPrice < 400) {
                    divisor = 0.92;
                    tempPrice = (totalCost + profit) / divisor;
                }

                const ceilPrice = Math.ceil(tempPrice);
                let finalPrice = ceilPrice;
                const lastDigit = ceilPrice % 10;
                if (lastDigit !== 0 && lastDigit < 9) {
                    finalPrice = Math.floor(ceilPrice / 10) * 10 + 9;
                }

                return {
                    totalCost: Math.round(totalCost),
                    divisor,
                    finalPrice,
                    shippingTwd: Math.round(weight * shippingRate)
                };
            };

            useEffect(() => {
                if (jpyPrice > 0 || weight > 0) {
                    setResultA(calculatePricing(false));
                    setResultB(calculatePricing(true));
                }
            }, [jpyPrice, weight, bankRate]);

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="mb-8 border-l-4 border-indigo-600 pl-4">
                            <h1 className="text-2xl font-bold text-slate-900">跨境電商精算專家 V3.3</h1>
                            <p className="text-slate-500 text-sm">老闆親征深度精算版 - 內部簡潔版</p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <label className="block text-sm font-semibold text-slate-600 mb-2">台銀日幣現金賣出匯率</label>
                                <input type="number" step="0.0001" value={bankRate} onChange={(e) => setBankRate(e.target.value)} className="w-full text-lg font-mono border-b-2 border-slate-200 focus:border-indigo-500 outline-none pb-1" />
                                <p className="mt-2 text-xs text-indigo-600 font-bold">最終採計：{(parseFloat(bankRate) + 0.02).toFixed(4)}</p>
                            </div>
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <label className="block text-sm font-semibold text-slate-600 mb-2">商品原價 (JPY)</label>
                                <input type="number" value={jpyPrice} onChange={(e) => setJpyPrice(e.target.value)} className="w-full text-lg font-mono border-b-2 border-slate-200 focus:border-indigo-500 outline-none pb-1" />
                            </div>
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <label className="block text-sm font-semibold text-slate-600 mb-2">重量 (g)</label>
                                <input type="number" value={weight} onChange={(e) => setWeight(e.target.value)} className="w-full text-lg font-mono border-b-2 border-slate-200 focus:border-indigo-500 outline-none pb-1" />
                            </div>
                        </div>

                        {resultA && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 animate-in fade-in duration-500">
                                <div className="bg-white rounded-2xl shadow-md border-t-4 border-blue-500 overflow-hidden">
                                    <div className="bg-blue-50 px-6 py-3 border-b border-blue-100 flex justify-between items-center">
                                        <span className="font-bold text-blue-800">方案 A：標準空運</span>
                                    </div>
                                    <div className="p-6">
                                        <div className="flex justify-between items-end mb-6">
                                            <span className="text-slate-500 text-sm font-bold">建議售價</span>
                                            <span className="text-4xl font-black text-slate-900"><span className="text-xl mr-1 font-normal">TWD</span>{resultA.finalPrice}</span>
                                        </div>
                                        <div className="space-y-3 border-t pt-4 text-sm">
                                            <div className="flex justify-between text-slate-500"><span>總成本</span><span className="font-mono">TWD {resultA.totalCost}</span></div>
                                            <div className="flex justify-between text-slate-500"><span>國際運費</span><span className="font-mono">TWD {resultA.shippingTwd}</span></div>
                                            <div className="flex justify-between text-slate-400 italic"><span>逆算參數</span><span className="font-mono">{resultA.divisor}</span></div>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-2xl shadow-md border-t-4 border-orange-500 overflow-hidden">
                                    <div className="bg-orange-50 px-6 py-3 border-b border-orange-100 flex justify-between items-center">
                                        <span className="font-bold text-orange-800">方案 B：老闆親征</span>
                                    </div>
                                    <div className="p-6">
                                        <div className="flex justify-between items-end mb-6">
                                            <span className="text-slate-500 text-sm font-bold">建議售價</span>
                                            <span className="text-4xl font-black text-slate-900"><span className="text-xl mr-1 font-normal">TWD</span>{resultB.finalPrice}</span>
                                        </div>
                                        <div className="space-y-3 border-t pt-4 text-sm">
                                            <div className="flex justify-between text-slate-500"><span>總成本</span><span className="font-mono">TWD {resultB.totalCost}</span></div>
                                            <div className="flex justify-between text-orange-600 font-bold"><span>國際運費</span><span>免運</span></div>
                                            <div className="flex justify-between text-slate-400 italic"><span>逆算參數</span><span className="font-mono">{resultB.divisor}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

讓我預覽
